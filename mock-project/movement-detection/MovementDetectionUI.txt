This complex code takes care of the visual part of the application.

(impressive, is it not?)